{"version":3,"sources":["file:///Users/even/workspace/github/yilinershi/pitaya_cocos_demo/client/node_modules/protobufjs/src/rpc/service.js"],"names":["_cjsLoader","_req","__cjsMetaURL","url","define","exports","require","module","__filename","__dirname","Service","util","prototype","Object","create","EventEmitter","constructor","rpcImpl","requestDelimited","responseDelimited","TypeError","call","Boolean","rpcCall","method","requestCtor","responseCtor","request","callback","self","asPromise","setTimeout","Error","undefined","finish","rpcCallback","err","response","emit","end","endedByRPC","off","_cjsExports"],"mappings":"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","sourcesContent":["import _cjsLoader from 'cce:/internal/ml/cjs-loader.mjs';\nimport { __cjsMetaURL as _req} from '../util/minimal';\nlet _cjsExports;\nconst __cjsMetaURL = import.meta.url;\n_cjsLoader.define(__cjsMetaURL, function (exports, require, module, __filename, __dirname) {\n// #region ORIGINAL CODE\n\n\n \"use strict\";\n module.exports = Service;\n\n var util = require(\"../util/minimal\");\n\n // Extends EventEmitter\n (Service.prototype = Object.create(util.EventEmitter.prototype)).constructor = Service;\n\n /**\n  * A service method callback as used by {@link rpc.ServiceMethod|ServiceMethod}.\n  *\n  * Differs from {@link RPCImplCallback} in that it is an actual callback of a service method which may not return `response = null`.\n  * @typedef rpc.ServiceMethodCallback\n  * @template TRes extends Message<TRes>\n  * @type {function}\n  * @param {Error|null} error Error, if any\n  * @param {TRes} [response] Response message\n  * @returns {undefined}\n  */\n\n /**\n  * A service method part of a {@link rpc.Service} as created by {@link Service.create}.\n  * @typedef rpc.ServiceMethod\n  * @template TReq extends Message<TReq>\n  * @template TRes extends Message<TRes>\n  * @type {function}\n  * @param {TReq|Properties<TReq>} request Request message or plain object\n  * @param {rpc.ServiceMethodCallback<TRes>} [callback] Node-style callback called with the error, if any, and the response message\n  * @returns {Promise<Message<TRes>>} Promise if `callback` has been omitted, otherwise `undefined`\n  */\n\n /**\n  * Constructs a new RPC service instance.\n  * @classdesc An RPC service as returned by {@link Service#create}.\n  * @exports rpc.Service\n  * @extends util.EventEmitter\n  * @constructor\n  * @param {RPCImpl} rpcImpl RPC implementation\n  * @param {boolean} [requestDelimited=false] Whether requests are length-delimited\n  * @param {boolean} [responseDelimited=false] Whether responses are length-delimited\n  */\n function Service(rpcImpl, requestDelimited, responseDelimited) {\n\n     if (typeof rpcImpl !== \"function\")\n         throw TypeError(\"rpcImpl must be a function\");\n\n     util.EventEmitter.call(this);\n\n     /**\n      * RPC implementation. Becomes `null` once the service is ended.\n      * @type {RPCImpl|null}\n      */\n     this.rpcImpl = rpcImpl;\n\n     /**\n      * Whether requests are length-delimited.\n      * @type {boolean}\n      */\n     this.requestDelimited = Boolean(requestDelimited);\n\n     /**\n      * Whether responses are length-delimited.\n      * @type {boolean}\n      */\n     this.responseDelimited = Boolean(responseDelimited);\n }\n\n /**\n  * Calls a service method through {@link rpc.Service#rpcImpl|rpcImpl}.\n  * @param {Method|rpc.ServiceMethod<TReq,TRes>} method Reflected or static method\n  * @param {Constructor<TReq>} requestCtor Request constructor\n  * @param {Constructor<TRes>} responseCtor Response constructor\n  * @param {TReq|Properties<TReq>} request Request message or plain object\n  * @param {rpc.ServiceMethodCallback<TRes>} callback Service callback\n  * @returns {undefined}\n  * @template TReq extends Message<TReq>\n  * @template TRes extends Message<TRes>\n  */\n Service.prototype.rpcCall = function rpcCall(method, requestCtor, responseCtor, request, callback) {\n\n     if (!request)\n         throw TypeError(\"request must be specified\");\n\n     var self = this;\n     if (!callback)\n         return util.asPromise(rpcCall, self, method, requestCtor, responseCtor, request);\n\n     if (!self.rpcImpl) {\n         setTimeout(function() { callback(Error(\"already ended\")); }, 0);\n         return undefined;\n     }\n\n     try {\n         return self.rpcImpl(\n             method,\n             requestCtor[self.requestDelimited ? \"encodeDelimited\" : \"encode\"](request).finish(),\n             function rpcCallback(err, response) {\n\n                 if (err) {\n                     self.emit(\"error\", err, method);\n                     return callback(err);\n                 }\n\n                 if (response === null) {\n                     self.end(/* endedByRPC */ true);\n                     return undefined;\n                 }\n\n                 if (!(response instanceof responseCtor)) {\n                     try {\n                         response = responseCtor[self.responseDelimited ? \"decodeDelimited\" : \"decode\"](response);\n                     } catch (err) {\n                         self.emit(\"error\", err, method);\n                         return callback(err);\n                     }\n                 }\n\n                 self.emit(\"data\", response, method);\n                 return callback(null, response);\n             }\n         );\n     } catch (err) {\n         self.emit(\"error\", err, method);\n         setTimeout(function() { callback(err); }, 0);\n         return undefined;\n     }\n };\n\n /**\n  * Ends this service and emits the `end` event.\n  * @param {boolean} [endedByRPC=false] Whether the service has been ended by the RPC implementation.\n  * @returns {rpc.Service} `this`\n  */\n Service.prototype.end = function end(endedByRPC) {\n     if (this.rpcImpl) {\n         if (!endedByRPC) // signal end to rpcImpl\n             this.rpcImpl(null, null, null);\n         this.rpcImpl = null;\n         this.emit(\"end\").off();\n     }\n     return this;\n };\n\n\n// #endregion ORIGINAL CODE\n\n_cjsExports = module.exports;\n\n\n}, () => ({\n  '../util/minimal': _req,\n}));\nexport { _cjsExports as default };\nexport { __cjsMetaURL }\n"]}